---
import LoadingSpinner from "./LoadingSpinner.astro";
const baseUrl = import.meta.env.BASE_URL;
---

<div id="review-container" class="max-w-4xl mx-auto">
  <div id="review-content" class="hidden">
    <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
      <div class="flex justify-between items-center mb-6">
        <div>
          <h2 class="text-2xl font-bold text-gray-800">Quiz Review</h2>
          <p class="text-gray-600">Review all questions and answers</p>
        </div>
        <div class="text-right">
          <p class="text-sm text-gray-600">Final Score</p>
          <p id="review-final-score" class="text-2xl font-bold text-indigo-600">
            0/0
          </p>
        </div>
      </div>

      <div class="flex gap-3">
        <a
          href={`${baseUrl}/quiz`}
          class="px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500"
        >
          ← Back to Quiz
        </a>
        <button
          id="review-header-new-quiz-button"
          class="px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500"
        >
          Start New Quiz
        </button>
      </div>
    </div>

    <div id="review-questions" class="space-y-6"></div>

    <div class="bg-white rounded-lg shadow-lg p-6 mt-6 text-center">
      <button
        id="review-bottom-new-quiz-button"
        class="inline-block px-6 py-3 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500"
      >
        Start New Quiz
      </button>
    </div>
  </div>

  <div id="review-loading" class="text-center py-16">
    <LoadingSpinner message="Loading quiz review..." />
  </div>

  <div id="review-error" class="hidden text-center py-16">
    <div class="text-red-500 text-6xl mb-4">⚠️</div>
    <h3 class="text-xl font-semibold text-gray-800 mb-2">No Quiz Data Found</h3>
    <p class="text-gray-600 mb-6">
      No completed quiz was found. Please complete a quiz to see the review.
    </p>
    <button
      id="review-error-new-quiz-button"
      class="inline-block px-6 py-3 bg-indigo-600 text-white rounded-md hover:bg-indigo-700"
    >
      Start New Quiz
    </button>
  </div>
</div>

<script>
  import { QuizReviewManager } from "../scripts/quizReview";

  window.addEventListener("DOMContentLoaded", () => {
    new QuizReviewManager();
  });
</script>
